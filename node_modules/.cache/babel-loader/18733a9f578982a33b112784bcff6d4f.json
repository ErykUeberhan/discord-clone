{"ast":null,"code":"import _slicedToArray from\"C:/Users/eryko/Desktop/ReactProjects/discord-clone/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useEffect,useState}from'react';import'./Category.css';import{FiChevronDown,FiChevronRight}from'react-icons/fi';import Channel from'./Channel';import db from'./firebase';import{useDispatch,useSelector}from'react-redux';import{selectCategoryId,selectServerId,setCategoryInfo,setChannelInfo}from'./features/counter/appSlice';import firebase from'firebase';import{BsX,BsPlus}from\"react-icons/bs\";function Category(_ref){var id=_ref.id,title=_ref.title;var categoryId=useSelector(selectCategoryId);var serverId=useSelector(selectServerId);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),channels=_useState2[0],setChannels=_useState2[1];var dispatch=useDispatch();var addChannel=function addChannel(){var channelName=prompt('Add channel:');if(channelName){db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').add({timestamp:firebase.firestore.FieldValue.serverTimestamp(),channelName:channelName});}};var removeCategory=function removeCategory(){var category=db.collection('servers').doc(serverId).collection('categories').doc(categoryId);var channel=category.collection('channels');channel.get().then(function(res){res.forEach(function(element){element.ref.collection('messages').get().then(function(res){res.forEach(function(element){element.ref.delete();});element.ref.delete();});element.ref.delete();});});category.delete();dispatch(setChannelInfo({channelId:null}));dispatch(setCategoryInfo({categoryId:null}));};useEffect(function(){if(categoryId){db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').orderBy('timestamp').onSnapshot(function(snapshot){return setChannels(snapshot.docs.map(function(doc){return{id:doc.id,channel:doc.data()};}));});}},[categoryId,serverId]);return/*#__PURE__*/_jsxs(\"div\",{className:\"category\",onClick:function onClick(){if(id!==categoryId){dispatch(setChannelInfo({channelId:null,channelName:null}));dispatch(setCategoryInfo({categoryId:id,categoryName:title}));}},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"category_header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"category_header_title\",children:[id===categoryId?/*#__PURE__*/_jsx(FiChevronDown,{}):/*#__PURE__*/_jsx(FiChevronRight,{}),/*#__PURE__*/_jsx(\"p\",{children:title})]}),/*#__PURE__*/_jsx(\"div\",{className:\"category_header_menu\",children:id===categoryId?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(BsPlus,{className:\"category_header_menu_add\",onClick:addChannel}),/*#__PURE__*/_jsx(BsX,{className:\"category_header_menu_remove\",onClick:removeCategory})]}):null})]}),/*#__PURE__*/_jsx(\"div\",{className:\"category_channels\",children:id===categoryId?channels.map(function(_ref2){var id=_ref2.id,channel=_ref2.channel;return/*#__PURE__*/_jsx(Channel,{id:id,title:channel.channelName},id);}):null})]});}export default Category;","map":{"version":3,"sources":["C:/Users/eryko/Desktop/ReactProjects/discord-clone/src/Category.js"],"names":["React","useEffect","useState","FiChevronDown","FiChevronRight","Channel","db","useDispatch","useSelector","selectCategoryId","selectServerId","setCategoryInfo","setChannelInfo","firebase","BsX","BsPlus","Category","id","title","categoryId","serverId","channels","setChannels","dispatch","addChannel","channelName","prompt","collection","doc","add","timestamp","firestore","FieldValue","serverTimestamp","removeCategory","category","channel","get","then","res","forEach","element","ref","delete","channelId","orderBy","onSnapshot","snapshot","docs","map","data","categoryName"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport './Category.css'\r\nimport { FiChevronDown, FiChevronRight } from 'react-icons/fi'\r\nimport Channel from './Channel'\r\nimport db from './firebase'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { selectCategoryId, selectServerId, setCategoryInfo, setChannelInfo } from './features/counter/appSlice'\r\nimport firebase from 'firebase'\r\nimport { BsX, BsPlus } from \"react-icons/bs\";\r\n\r\nfunction Category({ id, title }) {\r\n    const categoryId = useSelector(selectCategoryId)\r\n    const serverId = useSelector(selectServerId)\r\n    const [channels, setChannels] = useState([])\r\n    const dispatch = useDispatch();\r\n\r\n    const addChannel = () => {\r\n        const channelName = prompt('Add channel:');\r\n        if (channelName) {\r\n            db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').add({\r\n                timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n                channelName: channelName,\r\n            });\r\n        }\r\n    }\r\n\r\n    const removeCategory = () => {\r\n        const category = db.collection('servers').doc(serverId).collection('categories').doc(categoryId);\r\n        const channel = category.collection('channels');\r\n        channel.get().then((res) => {\r\n            res.forEach((element) => {\r\n                element.ref.collection('messages').get().then((res) => {\r\n                    res.forEach((element) => {\r\n                        element.ref.delete();\r\n                    });\r\n                    element.ref.delete();\r\n                });\r\n                element.ref.delete();\r\n            });\r\n        });\r\n\r\n        category.delete();\r\n\r\n        dispatch(\r\n            setChannelInfo({\r\n                channelId: null,\r\n            })\r\n        );\r\n\r\n        dispatch(\r\n            setCategoryInfo({\r\n                categoryId: null,\r\n            })\r\n        );\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (categoryId) {\r\n            db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').orderBy('timestamp').onSnapshot((snapshot) =>\r\n                setChannels(snapshot.docs.map((doc) => ({\r\n                    id: doc.id,\r\n                    channel: doc.data(),\r\n                }))));\r\n        }\r\n\r\n    }, [categoryId, serverId])\r\n    return (\r\n        <div className='category' onClick={() => {\r\n            if (id !== categoryId) {\r\n                dispatch(\r\n                    setChannelInfo({\r\n                        channelId: null,\r\n                        channelName: null,\r\n                    })\r\n                )\r\n\r\n                dispatch(\r\n                    setCategoryInfo({\r\n                        categoryId: id,\r\n                        categoryName: title,\r\n                    })\r\n                )\r\n            }\r\n\r\n        }}>\r\n            <div className='category_header'>\r\n                <div className='category_header_title'>\r\n                    {id === categoryId\r\n                        ?\r\n                        <FiChevronDown />\r\n                        :\r\n                        <FiChevronRight />\r\n                    }\r\n                    <p>{title}</p>\r\n                </div>\r\n                <div className='category_header_menu'>\r\n                    {id === categoryId\r\n                        ?\r\n                        <>\r\n                            <BsPlus className='category_header_menu_add' onClick={addChannel} />\r\n                            <BsX className='category_header_menu_remove' onClick={removeCategory} />\r\n                        </>\r\n                        : null\r\n                    }\r\n                </div>\r\n            </div>\r\n            <div className='category_channels'>\r\n                {id === categoryId\r\n                    ?\r\n                    channels.map(({ id, channel }) => (\r\n                        <Channel key={id} id={id} title={channel.channelName} />\r\n                    ))\r\n                    : null\r\n                }\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Category\r\n"]},"metadata":{},"sourceType":"module"}