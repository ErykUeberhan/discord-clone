{"ast":null,"code":"import _slicedToArray from\"C:/Users/eryko/Desktop/ReactProjects/discord-clone/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState}from'react';import'./Chat.css';import{MdAddCircle}from\"react-icons/md\";import{FaGift,FaSmile}from\"react-icons/fa\";import{RiFileGifFill}from\"react-icons/ri\";import{MdSend}from\"react-icons/md\";import Message from'./Message';import{useEffect}from'react';import db from'./firebase';import{useSelector}from'react-redux';import{selectUser}from'./features/counter/userSlice';import{selectCategoryId,selectChannelId,selectChannelName,selectServerId}from'./features/counter/appSlice';import firebase from'firebase';import{FaHashtag}from\"react-icons/fa\";function Chat(){var user=useSelector(selectUser);var u=firebase.auth().currentUser;var categoryId=useSelector(selectCategoryId);var serverId=useSelector(selectServerId);var channelId=useSelector(selectChannelId);var channelName=useSelector(selectChannelName);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),messages=_useState2[0],setMessages=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),messageText=_useState4[0],setMessageText=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),messagesEnd=_useState6[0],setMessagesEnd=_useState6[1];var _useState7=useState('server'),_useState8=_slicedToArray(_useState7,1),serverName=_useState8[0];// send message to database\nvar sendMessage=function sendMessage(){if(channelId&&messageText.length>0){var nick='';// set user nick\nif(user)nick=user.email.slice(0,user.email.indexOf('@'));// check date format\nvar dateEdit=function dateEdit(date){if(date<10)return\"0\".concat(date);else return date;};// set date string\nvar d=new Date();var day=d.getDate();var month=d.getMonth();var year=d.getFullYear();var hours=d.getHours();var minutes=d.getMinutes();var date=\"\".concat(dateEdit(hours),\":\").concat(dateEdit(minutes),\" \\xA0 \").concat(dateEdit(day),\"/\").concat(dateEdit(month),\"/\").concat(dateEdit(year));// add messsage to database\ndb.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').doc(channelId).collection('messages').add({timestamp:firebase.firestore.FieldValue.serverTimestamp(),message:messageText,nick:nick,date:date,avatarColor:u.photoURL});// set input value\nsetMessageText('');}};// insert data from database to messages array\nuseEffect(function(){if(channelId){db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').doc(channelId).collection(\"messages\").orderBy('timestamp').onSnapshot(function(snapshot){return setMessages(snapshot.docs.map(function(doc){return{id:doc.id,msg:doc.data()};}));});}},[channelId,categoryId,serverId]);return/*#__PURE__*/_jsxs(\"div\",{className:\"chat\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat_messages\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"chat_messages_top\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat_messages_bottom\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat_messages_bottom_channel\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"chat_messages_bottom_channel_icon\",children:/*#__PURE__*/_jsx(FaHashtag,{})}),/*#__PURE__*/_jsxs(\"p\",{className:\"chat_messages_bottom_channel_welcome\",children:[\"Welcome to #\",channelName?channelName:serverName,\"!\"]}),channelName?/*#__PURE__*/_jsxs(\"p\",{className:\"chat_messages_bottom_channel_description\",children:[\"This is the start of the #\",channelName?channelName:serverName,\" channel.\"]}):/*#__PURE__*/_jsx(\"p\",{className:\"chat_messages_bottom_channel_description\",children:\"Choose category and channel.\"})]}),// render messages from array\nchannelId?messages.map(function(_ref){var id=_ref.id,msg=_ref.msg;return/*#__PURE__*/_jsx(Message,{id:id,message:msg.message,nick:msg.nick,date:msg.date,avatarColor:msg.avatarColor},id);}):null,/*#__PURE__*/_jsx(\"div\",{ref:function ref(el){return setMessagesEnd(el);}}),// scroll to new added message\nmessagesEnd?messagesEnd.scrollIntoView({behavior:'smooth'}):null]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat_sendTextField\",children:[/*#__PURE__*/_jsx(MdAddCircle,{className:\"chat_sendTextField_icon\"}),channelName?/*#__PURE__*/_jsx(\"input\",{className:\"chat_sendTextField_input\",onChange:function onChange(event){return setMessageText(event.target.value);},onKeyPress:function onKeyPress(event){if(event.charCode===13)sendMessage();},value:messageText,placeholder:\"Message #\".concat(channelName)}):/*#__PURE__*/_jsx(\"input\",{className:\"chat_sendTextField_input\",onChange:function onChange(event){return setMessageText(event.target.value);},value:messageText,placeholder:\"Message #\".concat(serverName),readOnly:\"readonly\"}),/*#__PURE__*/_jsx(MdSend,{className:\"chat_sendTextField_send\",onClick:sendMessage}),/*#__PURE__*/_jsx(FaGift,{className:\"chat_sendTextField_icon\"}),/*#__PURE__*/_jsx(RiFileGifFill,{className:\"chat_sendTextField_icon\"}),/*#__PURE__*/_jsx(FaSmile,{className:\"chat_sendTextField_icon\"})]})]});}export default Chat;","map":{"version":3,"sources":["C:/Users/eryko/Desktop/ReactProjects/discord-clone/src/Chat.js"],"names":["React","useState","MdAddCircle","FaGift","FaSmile","RiFileGifFill","MdSend","Message","useEffect","db","useSelector","selectUser","selectCategoryId","selectChannelId","selectChannelName","selectServerId","firebase","FaHashtag","Chat","user","u","auth","currentUser","categoryId","serverId","channelId","channelName","messages","setMessages","messageText","setMessageText","messagesEnd","setMessagesEnd","serverName","sendMessage","length","nick","email","slice","indexOf","dateEdit","date","d","Date","day","getDate","month","getMonth","year","getFullYear","hours","getHours","minutes","getMinutes","collection","doc","add","timestamp","firestore","FieldValue","serverTimestamp","message","avatarColor","photoURL","orderBy","onSnapshot","snapshot","docs","map","id","msg","data","el","scrollIntoView","behavior","event","target","value","charCode"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport './Chat.css';\r\nimport { MdAddCircle } from \"react-icons/md\";\r\nimport { FaGift, FaSmile } from \"react-icons/fa\";\r\nimport { RiFileGifFill } from \"react-icons/ri\";\r\nimport { MdSend } from \"react-icons/md\";\r\nimport Message from './Message';\r\nimport { useEffect } from 'react';\r\nimport db from './firebase';\r\nimport { useSelector } from 'react-redux';\r\nimport { selectUser } from './features/counter/userSlice';\r\nimport { selectCategoryId, selectChannelId, selectChannelName, selectServerId } from './features/counter/appSlice';\r\nimport firebase from 'firebase';\r\nimport { FaHashtag } from \"react-icons/fa\";\r\n\r\nfunction Chat() {\r\n    const user = useSelector(selectUser);\r\n    const u = firebase.auth().currentUser;\r\n    const categoryId = useSelector(selectCategoryId);\r\n    const serverId = useSelector(selectServerId);\r\n    const channelId = useSelector(selectChannelId);\r\n    const channelName = useSelector(selectChannelName);\r\n    const [messages, setMessages] = useState([]);\r\n    const [messageText, setMessageText] = useState('');\r\n    const [messagesEnd, setMessagesEnd] = useState();\r\n    const [serverName] = useState('server');\r\n\r\n    // send message to database\r\n    const sendMessage = () => {\r\n        if (channelId && messageText.length > 0) {\r\n            let nick = ''\r\n\r\n            // set user nick\r\n            if (user) nick = user.email.slice(0, user.email.indexOf('@'));\r\n\r\n            // check date format\r\n            const dateEdit = (date) => {\r\n                if (date < 10) return `0${date}`\r\n                else return date\r\n            }\r\n\r\n            // set date string\r\n            let d = new Date();\r\n            let day = d.getDate();\r\n            let month = d.getMonth();\r\n            let year = d.getFullYear();\r\n            let hours = d.getHours();\r\n            let minutes = d.getMinutes();\r\n            let date = `${dateEdit(hours)}:${dateEdit(minutes)} \\xa0 ${dateEdit(day)}/${dateEdit(month)}/${dateEdit(year)}`;\r\n\r\n            // add messsage to database\r\n            db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').doc(channelId).collection('messages').add({\r\n                timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n                message: messageText,\r\n                nick,\r\n                date,\r\n                avatarColor: u.photoURL,\r\n            })\r\n\r\n            // set input value\r\n            setMessageText('');\r\n        }\r\n    }\r\n\r\n    // insert data from database to messages array\r\n    useEffect(() => {\r\n        if (channelId) {\r\n            db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').doc(channelId).collection(\"messages\").orderBy('timestamp').onSnapshot((snapshot) =>\r\n                setMessages(\r\n                    snapshot.docs.map((doc) => ({\r\n                        id: doc.id,\r\n                        msg: doc.data(),\r\n                    }))\r\n                )\r\n            );\r\n        }\r\n    }, [channelId, categoryId, serverId])\r\n    return (\r\n        <div className='chat'>\r\n            <div className='chat_messages'>\r\n                <div className='chat_messages_top'>\r\n\r\n                </div>\r\n                <div className='chat_messages_bottom' >\r\n                    <div className='chat_messages_bottom_channel'>\r\n                        <div className='chat_messages_bottom_channel_icon'><FaHashtag /></div>\r\n                        <p className='chat_messages_bottom_channel_welcome'>Welcome to #{channelName ? channelName : serverName}!</p>\r\n                        {\r\n                            channelName\r\n                                ?\r\n                                <p className='chat_messages_bottom_channel_description'>This is the start of the #{channelName ? channelName : serverName} channel.</p>\r\n                                :\r\n                                <p className='chat_messages_bottom_channel_description'>Choose category and channel.</p>\r\n                        }\r\n                    </div>\r\n                    {// render messages from array\r\n                        channelId\r\n                            ?\r\n                            messages.map(({ id, msg }) => (\r\n                                <Message key={id} id={id} message={msg.message} nick={msg.nick} date={msg.date} avatarColor={msg.avatarColor} />\r\n                            ))\r\n                            :\r\n                            null\r\n                    }\r\n\r\n                    <div ref={(el) => setMessagesEnd(el)} />\r\n\r\n                    {// scroll to new added message\r\n                        (messagesEnd)\r\n                            ?\r\n                            messagesEnd.scrollIntoView({ behavior: 'smooth' })\r\n                            :\r\n                            null\r\n                    }\r\n\r\n                </div>\r\n            </div>\r\n            <div className='chat_sendTextField'>\r\n\r\n                <MdAddCircle className='chat_sendTextField_icon' />\r\n                {\r\n                    channelName\r\n                        ?\r\n                        <input className='chat_sendTextField_input' onChange={(event) => setMessageText(event.target.value)} onKeyPress={(event) => { if (event.charCode === 13) sendMessage() }} value={messageText} placeholder={`Message #${channelName}`} />\r\n                        :\r\n                        <input className='chat_sendTextField_input' onChange={(event) => setMessageText(event.target.value)} value={messageText} placeholder={`Message #${serverName}`} readOnly='readonly' />\r\n                }\r\n                <MdSend className='chat_sendTextField_send' onClick={sendMessage} />\r\n                <FaGift className='chat_sendTextField_icon' />\r\n                <RiFileGifFill className='chat_sendTextField_icon' />\r\n                <FaSmile className='chat_sendTextField_icon' />\r\n\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Chat\r\n"]},"metadata":{},"sourceType":"module"}