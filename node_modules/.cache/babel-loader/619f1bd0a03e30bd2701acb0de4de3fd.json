{"ast":null,"code":"import _slicedToArray from\"C:/Users/eryko/Desktop/ReactProjects/discord-clone/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState}from'react';import'./Chat.css';import{MdAddCircle}from\"react-icons/md\";import{FaGift,FaSmile}from\"react-icons/fa\";import{RiFileGifFill}from\"react-icons/ri\";import{MdSend}from\"react-icons/md\";import Message from'./Message';import{useEffect}from'react';import db from'./firebase';import{useSelector}from'react-redux';import{selectUser}from'./features/counter/userSlice';import{selectCategoryId,selectChannelId,selectChannelName,selectServerId}from'./features/counter/appSlice';import firebase from'firebase';import{FaHashtag}from\"react-icons/fa\";function Chat(){var user=useSelector(selectUser);var u=firebase.auth().currentUser;var categoryId=useSelector(selectCategoryId);var serverId=useSelector(selectServerId);var channelId=useSelector(selectChannelId);var channelName=useSelector(selectChannelName);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),messages=_useState2[0],setMessages=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),messageText=_useState4[0],setMessageText=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),messagesEnd=_useState6[0],setMessagesEnd=_useState6[1];var _useState7=useState('server'),_useState8=_slicedToArray(_useState7,1),serverName=_useState8[0];var sendMessage=function sendMessage(){console.log(channelId);if(channelId){var nick='';if(user)nick=user.email.slice(0,user.email.indexOf('@'));var dateEdit=function dateEdit(date){if(date<10)return\"0\".concat(date);else return date;};var d=new Date();var day=d.getDate();var month=d.getMonth();var year=d.getFullYear();var hours=d.getHours();var minutes=d.getMinutes();var date=\"\".concat(dateEdit(hours),\":\").concat(dateEdit(minutes),\" \\xA0 \").concat(dateEdit(day),\"/\").concat(dateEdit(month),\"/\").concat(dateEdit(year));db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').doc(channelId).collection('messages').add({timestamp:firebase.firestore.FieldValue.serverTimestamp(),message:messageText,nick:nick,date:date,avatarColor:u.photoURL});}};useEffect(function(){if(channelId){db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').doc(channelId).collection(\"messages\").orderBy('timestamp').onSnapshot(function(snapshot){return setMessages(snapshot.docs.map(function(doc){return{id:doc.id,msg:doc.data()};}));});}},[channelId,categoryId,serverId]);return/*#__PURE__*/_jsxs(\"div\",{className:\"chat\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat_messages\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"chat_messages_top\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat_messages_bottom\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat_messages_bottom_emptyChannel\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"chat_messages_bottom_emptyChannel_icon\",children:/*#__PURE__*/_jsx(FaHashtag,{})}),/*#__PURE__*/_jsxs(\"p\",{className:\"chat_messages_bottom_emptyChannel_welcome\",children:[\"Welcome to #\",channelName?channelName:serverName,\"!\"]}),channelName?/*#__PURE__*/_jsxs(\"p\",{className:\"chat_messages_bottom_emptyChannel_description\",children:[\"This is the start of the #\",channelName?channelName:serverName,\" channel.\"]}):/*#__PURE__*/_jsx(\"p\",{className:\"chat_messages_bottom_emptyChannel_description\",children:\"Choose category and channel.\"})]}),messages.map(function(_ref){var id=_ref.id,msg=_ref.msg;return/*#__PURE__*/_jsx(Message,{id:id,message:msg.message,nick:msg.nick,date:msg.date,avatarColor:msg.avatarColor},id);}),messagesEnd?messagesEnd.scrollIntoView({behavior:'smooth'}):null,/*#__PURE__*/_jsx(\"div\",{ref:function ref(el){return setMessagesEnd(el);}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat_sendTextField\",children:[/*#__PURE__*/_jsx(MdAddCircle,{className:\"chat_sendTextField_icon\"}),channelName?/*#__PURE__*/_jsx(\"input\",{className:\"chat_sendTextField_input\",onChange:function onChange(event){return setMessageText(event.target.value);},placeholder:\"Message #\".concat(channelName)}):/*#__PURE__*/_jsx(\"input\",{className:\"chat_sendTextField_input\",onChange:function onChange(event){return setMessageText(event.target.value);},placeholder:\"Message #\".concat(serverName),readOnly:\"readonly\"}),/*#__PURE__*/_jsx(MdSend,{className:\"chat_sendTextField_send\",onClick:function onClick(){if(channelName&&messageText.length>0)sendMessage();}}),/*#__PURE__*/_jsx(FaGift,{className:\"chat_sendTextField_icon\"}),/*#__PURE__*/_jsx(RiFileGifFill,{className:\"chat_sendTextField_icon\"}),/*#__PURE__*/_jsx(FaSmile,{className:\"chat_sendTextField_icon\",onClick:function onClick(){return console.log(u.photoURL);}})]})]});}export default Chat;","map":{"version":3,"sources":["C:/Users/eryko/Desktop/ReactProjects/discord-clone/src/Chat.js"],"names":["React","useState","MdAddCircle","FaGift","FaSmile","RiFileGifFill","MdSend","Message","useEffect","db","useSelector","selectUser","selectCategoryId","selectChannelId","selectChannelName","selectServerId","firebase","FaHashtag","Chat","user","u","auth","currentUser","categoryId","serverId","channelId","channelName","messages","setMessages","messageText","setMessageText","messagesEnd","setMessagesEnd","serverName","sendMessage","console","log","nick","email","slice","indexOf","dateEdit","date","d","Date","day","getDate","month","getMonth","year","getFullYear","hours","getHours","minutes","getMinutes","collection","doc","add","timestamp","firestore","FieldValue","serverTimestamp","message","avatarColor","photoURL","orderBy","onSnapshot","snapshot","docs","map","id","msg","data","scrollIntoView","behavior","el","event","target","value","length"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport './Chat.css';\r\nimport { MdAddCircle } from \"react-icons/md\";\r\nimport { FaGift, FaSmile } from \"react-icons/fa\";\r\nimport { RiFileGifFill } from \"react-icons/ri\";\r\nimport { MdSend } from \"react-icons/md\";\r\nimport Message from './Message';\r\nimport { useEffect } from 'react';\r\nimport db from './firebase';\r\nimport { useSelector } from 'react-redux';\r\nimport { selectUser } from './features/counter/userSlice';\r\nimport { selectCategoryId, selectChannelId, selectChannelName, selectServerId } from './features/counter/appSlice';\r\nimport firebase from 'firebase';\r\nimport { FaHashtag } from \"react-icons/fa\";\r\n\r\nfunction Chat() {\r\n    const user = useSelector(selectUser);\r\n    const u = firebase.auth().currentUser;\r\n    const categoryId = useSelector(selectCategoryId);\r\n    const serverId = useSelector(selectServerId);\r\n    const channelId = useSelector(selectChannelId);\r\n    const channelName = useSelector(selectChannelName);\r\n    const [messages, setMessages] = useState([]);\r\n    const [messageText, setMessageText] = useState();\r\n    const [messagesEnd, setMessagesEnd] = useState();\r\n    const [serverName] = useState('server');\r\n\r\n\r\n    const sendMessage = () => {\r\n        console.log(channelId)\r\n        if (channelId) {\r\n            let nick = ''\r\n            if (user) nick = user.email.slice(0, user.email.indexOf('@'));\r\n\r\n            const dateEdit = (date) => {\r\n                if (date < 10) return `0${date}`\r\n                else return date\r\n            }\r\n            let d = new Date();\r\n            let day = d.getDate();\r\n            let month = d.getMonth();\r\n            let year = d.getFullYear();\r\n            let hours = d.getHours();\r\n            let minutes = d.getMinutes();\r\n            let date = `${dateEdit(hours)}:${dateEdit(minutes)} \\xa0 ${dateEdit(day)}/${dateEdit(month)}/${dateEdit(year)}`;\r\n\r\n            db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').doc(channelId).collection('messages').add({\r\n                timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n                message: messageText,\r\n                nick,\r\n                date,\r\n                avatarColor: u.photoURL,\r\n            })\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (channelId) {\r\n            db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').doc(channelId).collection(\"messages\").orderBy('timestamp').onSnapshot((snapshot) =>\r\n                setMessages(\r\n                    snapshot.docs.map((doc) => ({\r\n                        id: doc.id,\r\n                        msg: doc.data(),\r\n                    }))\r\n                )\r\n            );\r\n        }\r\n    }, [channelId, categoryId, serverId])\r\n    return (\r\n        <div className='chat'>\r\n            <div className='chat_messages'>\r\n                <div className='chat_messages_top'>\r\n\r\n                </div>\r\n                <div className='chat_messages_bottom' >\r\n                    <div className='chat_messages_bottom_emptyChannel'>\r\n                        <div className='chat_messages_bottom_emptyChannel_icon'><FaHashtag /></div>\r\n                        <p className='chat_messages_bottom_emptyChannel_welcome'>Welcome to #{channelName ? channelName : serverName}!</p>\r\n                        {\r\n                            channelName\r\n                                ?\r\n                                <p className='chat_messages_bottom_emptyChannel_description'>This is the start of the #{channelName ? channelName : serverName} channel.</p>\r\n                                :\r\n                                <p className='chat_messages_bottom_emptyChannel_description'>Choose category and channel.</p>\r\n                        }\r\n                    </div>\r\n                    {messages.map(({ id, msg }) => (\r\n                        <Message key={id} id={id} message={msg.message} nick={msg.nick} date={msg.date} avatarColor={msg.avatarColor} />\r\n                    ))}\r\n                    {(messagesEnd)\r\n                        ?\r\n                        messagesEnd.scrollIntoView({ behavior: 'smooth' })\r\n                        :\r\n                        null\r\n                    }\r\n\r\n\r\n\r\n                    <div ref={(el) => setMessagesEnd(el)}>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className='chat_sendTextField'>\r\n                <MdAddCircle className='chat_sendTextField_icon' />\r\n                {\r\n                    channelName\r\n                        ?\r\n                        <input className='chat_sendTextField_input' onChange={(event) => setMessageText(event.target.value)} placeholder={`Message #${channelName}`} />\r\n                        :\r\n                        <input className='chat_sendTextField_input' onChange={(event) => setMessageText(event.target.value)} placeholder={`Message #${serverName}`} readOnly='readonly' />\r\n                }\r\n                <MdSend className='chat_sendTextField_send' onClick={() => { if (channelName && messageText.length > 0) sendMessage() }} />\r\n                <FaGift className='chat_sendTextField_icon' />\r\n                <RiFileGifFill className='chat_sendTextField_icon' />\r\n                <FaSmile className='chat_sendTextField_icon' onClick={() => console.log(u.photoURL)} />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Chat\r\n"]},"metadata":{},"sourceType":"module"}