{"ast":null,"code":"import _slicedToArray from\"C:/Users/eryko/Desktop/ReactProjects/discord-clone/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useEffect,useState}from'react';import'./Category.css';import{FiChevronDown,FiChevronRight}from'react-icons/fi';import{FaHashtag}from\"react-icons/fa\";import{GoUnmute}from\"react-icons/go\";import Channel from'./Channel';import db from'./firebase';import{useDispatch,useSelector}from'react-redux';import{selectCategoryId,selectServerId,setCategoryInfo,setChannelInfo}from'./features/counter/appSlice';import firebase from'firebase';import{BsX,BsPlus}from\"react-icons/bs\";function Category(_ref){var id=_ref.id,title=_ref.title;var categoryId=useSelector(selectCategoryId);var serverId=useSelector(selectServerId);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),channels=_useState2[0],setChannels=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),channelName=_useState4[0],setChannelName=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),channelPrompt=_useState6[0],setChannelPrompt=_useState6[1];var dispatch=useDispatch();// add channel to database\nvar addChannel=function addChannel(){if(channelName){db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').add({timestamp:firebase.firestore.FieldValue.serverTimestamp(),channelName:channelName});}};// remove category from database\nvar removeCategory=function removeCategory(){var category=db.collection('servers').doc(serverId).collection('categories').doc(categoryId);var channel=category.collection('channels');// remove data belonging to this category\nchannel.get().then(function(res){res.forEach(function(element){element.ref.collection('messages').get().then(function(res){res.forEach(function(element){element.ref.delete();});element.ref.delete();});element.ref.delete();});});// delete category\ncategory.delete();// set local info about removed data to null\ndispatch(setChannelInfo({channelId:null}));dispatch(setCategoryInfo({categoryId:null}));};// insert data from database to channels array\nuseEffect(function(){if(categoryId){db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').orderBy('timestamp').onSnapshot(function(snapshot){return setChannels(snapshot.docs.map(function(doc){return{id:doc.id,channel:doc.data()};}));});}},[categoryId,serverId]);return/*#__PURE__*/_jsxs(\"div\",{className:\"category\",onClick:function onClick(){// send info about choosen category\nif(id!==categoryId){dispatch(setChannelInfo({channelId:null,channelName:null}));dispatch(setCategoryInfo({categoryId:id,categoryName:title}));}},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"category_header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"category_header_title\",children:[id===categoryId?/*#__PURE__*/_jsx(FiChevronDown,{}):/*#__PURE__*/_jsx(FiChevronRight,{}),/*#__PURE__*/_jsx(\"p\",{children:title})]}),/*#__PURE__*/_jsx(\"div\",{className:\"category_header_menu\",children:id===categoryId?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(BsPlus,{className:\"category_header_menu_add\",onClick:function onClick(){return setChannelPrompt(true);}}),/*#__PURE__*/_jsx(BsX,{className:\"category_header_menu_remove\",onClick:removeCategory})]}):null}),channelPrompt?/*#__PURE__*/_jsx(\"div\",{className:\"category_prompt\",onClick:function onClick(e){return e.stopPropagation();},children:/*#__PURE__*/_jsxs(\"div\",{className:\"category_prompt_field\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"category_prompt_field_title\",children:\"Create Channel\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"category_prompt_field_choose\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"category_prompt_field_choose_title\",children:\"CHANNEL TYPE\"}),/*#__PURE__*/_jsxs(\"label\",{className:\"category_prompt_field_choose_textChannel\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"channel\"}),/*#__PURE__*/_jsx(\"span\",{className:\"category_prompt_field_choose_textChannel_radiomark\"}),/*#__PURE__*/_jsx(FaHashtag,{}),/*#__PURE__*/_jsx(\"p\",{children:\"Text Channel\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"category_prompt_field_choose_voiceChannel\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"channel\"}),/*#__PURE__*/_jsx(\"span\",{className:\"category_prompt_field_choose_voiceChannel_radiomark\"}),/*#__PURE__*/_jsx(GoUnmute,{}),/*#__PURE__*/_jsx(\"p\",{children:\"Voice Channel\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"category_prompt_field_insert\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"category_prompt_field_insert_title\",children:\"CHANNEL NAME\"}),/*#__PURE__*/_jsx(\"input\",{className:\"category_prompt_field_insert_input\",onChange:function onChange(e){return setChannelName(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"category_prompt_field_buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"category_prompt_field_buttons_cancel\",onClick:function onClick(){return setChannelPrompt(false);},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{className:\"category_prompt_field_buttons_submit\",onClick:function onClick(){if(channelName.length>0)addChannel();setChannelPrompt(false);},children:\"Create\"})]})]})}):null]}),/*#__PURE__*/_jsx(\"div\",{className:\"category_channels\",children:// render channels from array\nid===categoryId?channels.map(function(_ref2){var id=_ref2.id,channel=_ref2.channel;return/*#__PURE__*/_jsx(Channel,{id:id,title:channel.channelName},id);}):null})]});}export default Category;","map":{"version":3,"sources":["C:/Users/eryko/Desktop/ReactProjects/discord-clone/src/Category.js"],"names":["React","useEffect","useState","FiChevronDown","FiChevronRight","FaHashtag","GoUnmute","Channel","db","useDispatch","useSelector","selectCategoryId","selectServerId","setCategoryInfo","setChannelInfo","firebase","BsX","BsPlus","Category","id","title","categoryId","serverId","channels","setChannels","channelName","setChannelName","channelPrompt","setChannelPrompt","dispatch","addChannel","collection","doc","add","timestamp","firestore","FieldValue","serverTimestamp","removeCategory","category","channel","get","then","res","forEach","element","ref","delete","channelId","orderBy","onSnapshot","snapshot","docs","map","data","categoryName","e","stopPropagation","target","value","length"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport './Category.css'\r\nimport { FiChevronDown, FiChevronRight } from 'react-icons/fi'\r\nimport { FaHashtag } from \"react-icons/fa\";\r\nimport { GoUnmute } from \"react-icons/go\";\r\nimport Channel from './Channel'\r\nimport db from './firebase'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { selectCategoryId, selectServerId, setCategoryInfo, setChannelInfo } from './features/counter/appSlice'\r\nimport firebase from 'firebase'\r\nimport { BsX, BsPlus } from \"react-icons/bs\";\r\n\r\nfunction Category({ id, title }) {\r\n    const categoryId = useSelector(selectCategoryId)\r\n    const serverId = useSelector(selectServerId)\r\n    const [channels, setChannels] = useState([])\r\n    const [channelName, setChannelName] = useState('');\r\n    const [channelPrompt, setChannelPrompt] = useState(false);\r\n    const dispatch = useDispatch();\r\n\r\n    // add channel to database\r\n    const addChannel = () => {\r\n        if (channelName) {\r\n            db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').add({\r\n                timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n                channelName: channelName,\r\n            });\r\n        }\r\n    }\r\n\r\n    // remove category from database\r\n    const removeCategory = () => {\r\n        const category = db.collection('servers').doc(serverId).collection('categories').doc(categoryId);\r\n        const channel = category.collection('channels');\r\n\r\n        // remove data belonging to this category\r\n        channel.get().then((res) => {\r\n            res.forEach((element) => {\r\n                element.ref.collection('messages').get().then((res) => {\r\n                    res.forEach((element) => {\r\n                        element.ref.delete();\r\n                    });\r\n                    element.ref.delete();\r\n                });\r\n                element.ref.delete();\r\n            });\r\n        });\r\n\r\n        // delete category\r\n        category.delete();\r\n\r\n        // set local info about removed data to null\r\n        dispatch(\r\n            setChannelInfo({\r\n                channelId: null,\r\n            })\r\n        );\r\n\r\n        dispatch(\r\n            setCategoryInfo({\r\n                categoryId: null,\r\n            })\r\n        );\r\n    }\r\n\r\n    // insert data from database to channels array\r\n    useEffect(() => {\r\n        if (categoryId) {\r\n            db.collection('servers').doc(serverId).collection('categories').doc(categoryId).collection('channels').orderBy('timestamp').onSnapshot((snapshot) =>\r\n                setChannels(snapshot.docs.map((doc) => ({\r\n                    id: doc.id,\r\n                    channel: doc.data(),\r\n                }))));\r\n        }\r\n\r\n    }, [categoryId, serverId])\r\n    return (\r\n        <div className='category' onClick={() => {\r\n            // send info about choosen category\r\n            if (id !== categoryId) {\r\n                dispatch(\r\n                    setChannelInfo({\r\n                        channelId: null,\r\n                        channelName: null,\r\n                    })\r\n                )\r\n\r\n                dispatch(\r\n                    setCategoryInfo({\r\n                        categoryId: id,\r\n                        categoryName: title,\r\n                    })\r\n                )\r\n            }\r\n\r\n        }}>\r\n            <div className='category_header'>\r\n                <div className='category_header_title'>\r\n                    {id === categoryId\r\n                        ?\r\n                        <FiChevronDown />\r\n                        :\r\n                        <FiChevronRight />\r\n                    }\r\n                    <p>{title}</p>\r\n                </div>\r\n                <div className='category_header_menu'>\r\n                    {id === categoryId\r\n                        ?\r\n                        <>\r\n                            <BsPlus className='category_header_menu_add' onClick={() => setChannelPrompt(true)} />\r\n                            <BsX className='category_header_menu_remove' onClick={removeCategory} />\r\n                        </>\r\n                        : null\r\n                    }\r\n                </div>\r\n                {\r\n                    channelPrompt\r\n                        ?\r\n                        <div className='category_prompt' onClick={(e) => e.stopPropagation()}>\r\n                            <div className='category_prompt_field'>\r\n                                <p className='category_prompt_field_title'>Create Channel</p>\r\n                                <div className='category_prompt_field_choose'>\r\n                                    <p className='category_prompt_field_choose_title'>CHANNEL TYPE</p>\r\n                                    <label className='category_prompt_field_choose_textChannel'>\r\n                                        <input type='radio' name='channel' />\r\n                                        <span className='category_prompt_field_choose_textChannel_radiomark'></span>\r\n                                        <FaHashtag />\r\n                                        <p>Text Channel</p>\r\n                                    </label>\r\n                                    <label className='category_prompt_field_choose_voiceChannel'>\r\n                                        <input type='radio' name='channel' />\r\n                                        <span className='category_prompt_field_choose_voiceChannel_radiomark'></span>\r\n                                        <GoUnmute />\r\n                                        <p>Voice Channel</p>\r\n                                    </label>\r\n                                </div>\r\n                                <div className='category_prompt_field_insert'>\r\n                                    <p className='category_prompt_field_insert_title'>CHANNEL NAME</p>\r\n                                    <input className='category_prompt_field_insert_input' onChange={(e) => setChannelName(e.target.value)} />\r\n                                </div>\r\n                                <div className='category_prompt_field_buttons'>\r\n                                    <button className='category_prompt_field_buttons_cancel' onClick={() => setChannelPrompt(false)}>Cancel</button>\r\n                                    <button className='category_prompt_field_buttons_submit' onClick={() => { if (channelName.length > 0) addChannel(); setChannelPrompt(false) }}>Create</button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        :\r\n                        null\r\n                }\r\n            </div>\r\n            <div className='category_channels'>\r\n                {// render channels from array\r\n                    id === categoryId\r\n                        ?\r\n                        channels.map(({ id, channel }) => (\r\n                            <Channel key={id} id={id} title={channel.channelName} />\r\n                        ))\r\n                        : null\r\n                }\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Category\r\n"]},"metadata":{},"sourceType":"module"}